<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAKANAYA JAPON - PRODUCT LIST</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body>
    <header>
        <div class="header-container">
            <img src="images/logo.jpg" alt="SAKANAYA JAPON" class="logo">
            <div class="contact-area">
                <a href="tel:016881370" class="tel-link">üìû 016-881-370</a>
                <div class="btns">
                    <a href="https://t.me/SAKANAYAJAPON_SUPPORT" target="_blank" class="telegram-btn">Telegram</a>
                </div>
            </div>
            <h2 class="title-main">PRODUCT LIST</h2>
            <p class="update-date">UPDATE: 2026/01/15</p>
        </div>
    </header>

   <nav>
        <button class="nav-btn active" onclick="filterCategory('ALL', this)">ALL</button>
        <button class="nav-btn" onclick="filterCategory('FRESH', this)">FRESH</button>
        <button class="nav-btn" onclick="filterCategory('FROZEN', this)">FROZEN</button>
        <button class="nav-btn" onclick="filterCategory('JAPAN', this)">JAPAN Farmed</button> 
    </nav>

    <div class="notice-area">
        <div class="notice-box">
            <h4>„Äê FRESH PRODUCTS NOTICE „Äë</h4>
            <p>
                <strong>JP:</strong> FRESH„Å´Èñ¢„Åó„Å¶„ÅØ„ÄÅ„Éï„Ç£„É¨„Åã„Çâ„ÅîÊ≥®ÊñáÈ†Ç„Åë„Åæ„Åô„ÄÇ„Åæ„Åü„ÄÅ„Éõ„Éº„É´„Å´Èñ¢„Åó„Å¶„ÅØ‰∏ãÂá¶ÁêÜÔºàÂÜÖËáìÂá¶ÁêÜ„ÄÅË°ÄÊäú„ÅçÔºâ„Çí„Åó„Å¶„ÅäÂ±ä„Åë„Åó„Å¶„Åä„Çä„Åæ„Åô„ÄÇ<br>
                <strong>EN:</strong> Fresh fish can be ordered as fillets. For whole fish, we deliver them pre-processed (gutted and bled).
            </p>
        </div>
    </div>

    <div id="product-container" class="container"></div>

    <section class="map-section">
        <h3>STORE LOCATION</h3>
        <div class="map-container">
            <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d3908.770617305943!2d104.9213!3d11.5644!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sja!2skh!4v1700000000000" width="100%" height="400" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
        </div>
    </section>

    <footer>
        <p>¬© 2026 SAKANAYA JAPON</p>
    </footer>

    <div id="total-bar" class="total-bar">
        <div class="total-content">
            <span class="total-label">Estimated Total:</span>
            <span class="total-price">$ <span id="total-amount">0.00</span></span>
        </div>
        <p class="total-note">*Excluding Delivery Fee</p>
    </div>

    <script>
    let allProducts = [];
    Papa.parse("products.csv", {
        download: true,
        header: true,
        skipEmptyLines: true,
        transformHeader: function(h) { return h.trim(); },
        complete: function(results) {
            allProducts = results.data;
            displayProducts(allProducts);
        }
    });

    function displayProducts(products) {
        const container = document.getElementById('product-container');
        container.innerHTML = '';
        products.forEach((p) => {
            if(!p.name) return;

            // < > Ë®òÂè∑„ÅÆÂÆâÂÖ®„Å™Ë°®Á§∫
            let safeName = p.name.replace(/</g, "&lt;").replace(/>/g, "&gt;");
            let formattedComment = (p.comment || '').replace(/„ÄÇ/g, '„ÄÇ<br><span class="en-comment">') + '</span>';

            // ÈÉ®‰Ωç„ÅÆÈÅ∏ÊäûËÇ¢„ÇíCSV„ÅÆw_Êï∞ÂÄ§„Åã„ÇâÂãïÁöÑ„Å´ÁîüÊàê
            let unitOptions = '';
            if (p.is_fixed === "0") {
                if(parseFloat(p.w_pc) > 0) unitOptions += `<option value="${p.w_pc}">1 pc (${p.w_pc}kg)</option>`;
                if(parseFloat(p.w_fillet) > 0) unitOptions += `<option value="${p.w_fillet}">1 fillet (${p.w_fillet}kg)</option>`;
                if(parseFloat(p.w_back) > 0) unitOptions += `<option value="${p.w_back}">Back side (${p.w_back}kg)</option>`;
                if(parseFloat(p.w_stomach) > 0) unitOptions += `<option value="${p.w_stomach}">Stomach side (${p.w_stomach}kg)</option>`;
            } else {
                unitOptions = `<option value="1">1 ${p.unit || 'pc'}</option>`;
            }

            const card = `
                <div class="card">
                    <div class="img-wrapper">
                        <img src="${p.image ? p.image.trim() : ''}" alt="${safeName}">
                        <span class="category-tag ${p.category}">
                            <img src="images/${p.category === 'JAPAN' ? 'jp-flag.png' : 'kh-flag.png'}" alt="flag" style="width: 20px; border: 1px solid #fff; border-radius: 2px; margin-right: 6px;">
                            ${p.category}
                        </span>
                    </div>
                    <div class="info">
                        <span class="code">Code: ${p.code}</span>
                        <h3>${safeName}</h3>
                        <div class="comment-box">${formattedComment}</div>
                        
                        <div class="price-size-area">
                            <p class="price" style="text-decoration: none !important;">
                                $${Number(p.price).toLocaleString()} <span class="unit-text">/ ${p.unit || 'kg'}</span>
                            </p>
                            ${(p.size && p.size !== 'size') ? `<p class="size-detail">Size: ${p.size}</p>` : ''}
                            
                            <div class="calc-container">
                                <div class="calc-row">
                                    <select class="unit-select" onchange="updateTotal()">
                                        ${unitOptions}
                                    </select>
                                    <span class="times">√ó</span>
                                    <input type="number" class="qty-input" min="0" value="0" 
                                           data-price="${p.price}" 
                                           onchange="updateTotal()" oninput="updateTotal()">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            container.innerHTML += card;
        });
    }

    function updateTotal() {
        let total = 0;
        const cards = document.querySelectorAll('.card');
        
        cards.forEach(card => {
            const select = card.querySelector('.unit-select');
            const input = card.querySelector('.qty-input');
            
            if (select && input) {
                const unitWeight = parseFloat(select.value) || 0;
                const pricePerKg = parseFloat(input.getAttribute('data-price')) || 0;
                const qty = parseFloat(input.value) || 0;
                
                total += pricePerKg * unitWeight * qty;
            }
        });
        
        document.getElementById('total-amount').innerText = total.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
        
        const bar = document.getElementById('total-bar');
        if (total > 0) {
            bar.classList.add('show');
        } else {
            bar.classList.remove('show');
        }
    }

    function filterCategory(cat, btn) {
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        cat === 'ALL' ? displayProducts(allProducts) : displayProducts(allProducts.filter(p => p.category === cat));
    }
    </script>
</body>
</html>
